<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>IA XAUUSD AUTO ‚Äì Intuici√≥n de Mercado</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://s3.tradingview.com/tv.js"></script>

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#0f1220;
  color:#fff;
}
header{
  padding:15px;
  text-align:center;
  background:#151933;
  font-size:20px;
  font-weight:bold;
}
.container{
  display:grid;
  grid-template-columns:2fr 1fr;
  gap:10px;
  padding:10px;
}
.panel{
  background:#151933;
  border-radius:10px;
  padding:10px;
}
#signal{
  font-size:22px;
  text-align:center;
  margin:10px 0;
}
#semaforo{
  width:25px;
  height:25px;
  border-radius:50%;
  margin:0 auto;
  background:gray;
}
input,button{
  width:100%;
  margin-top:5px;
  padding:6px;
  border:none;
  border-radius:5px;
}
button{
  background:#2e7cff;
  color:#fff;
  font-weight:bold;
}
#chat{
  height:180px;
  overflow-y:auto;
  background:#0f1220;
  padding:8px;
  border-radius:5px;
  font-size:13px;
}
.msg{
  margin-bottom:6px;
}
.ia{ color:#00ffcc; }
.user{ color:#ffd966; }
</style>
</head>

<body>

<header>üß† IA XAUUSD AUTO ‚Äì Copiloto de Trading</header>

<div class="container">

  <!-- GRAFICA -->
  <div class="panel">
    <div id="tvchart"></div>
  </div>

  <!-- PANEL IA -->
  <div class="panel">
    <div id="signal">‚è≥ Esperando mercado...</div>
    <div id="semaforo"></div>

    <hr>

    <label>Apalancamiento</label>
    <input type="number" id="leverage" value="50">

    <label>Lotes</label>
    <input type="number" id="lots" value="0.01" step="0.01">

    <label>Pips objetivo</label>
    <input type="number" id="pips" value="50">

    <button onclick="calcular()">Calcular Ganancia</button>
    <div id="resultado"></div>

    <hr>

    <div id="chat"></div>
    <input type="text" id="userInput" placeholder="Habla con la IA‚Ä¶">
    <button onclick="enviar()">Enviar</button>
  </div>

</div>

<script>
// üîë TU API KEY DE TWELVEDATA
const API_KEY = d3cd94ff08974ed893ad7f77c1cd3b87 ;

// TradingView
new TradingView.widget({
  autosize:true,
  symbol:"OANDA:XAUUSD",
  interval:"5",
  timezone:"Etc/UTC",
  theme:"dark",
  style:"1",
  locale:"es",
  container_id:"tvchart"
});

// Datos mercado
let precioActual = 0;

async function obtenerPrecio(){
  const res = await fetch(`https://api.twelvedata.com/price?symbol=XAU/USD&apikey=${API_KEY}`);
  const data = await res.json();
  if(data.price){
    precioActual = parseFloat(data.price);
    analizar();
  }
}
setInterval(obtenerPrecio,5000);

// IA ANAL√çTICA + INTUITIVA
function analizar(){
  let signal = "ESPERAR";
  let color = "gray";

  if(precioActual % 2 > 1){
    signal = "üìà COMPRA";
    color = "green";
  }else if(precioActual % 2 < 0.5){
    signal = "üìâ VENTA";
    color = "red";
  }

  document.getElementById("signal").innerText = signal;
  document.getElementById("semaforo").style.background = color;

  iaMensaje(`Precio actual: ${precioActual} ‚Üí Se√±al: ${signal}`);
}

// CALCULO
function calcular(){
  const lots = parseFloat(document.getElementById("lots").value);
  const pips = parseFloat(document.getElementById("pips").value);
  const ganancia = lots * pips * 10;
  document.getElementById("resultado").innerText =
    `üí∞ Ganancia estimada: $${ganancia.toFixed(2)}`;
}

// CHAT IA
function enviar(){
  const input = document.getElementById("userInput");
  const texto = input.value;
  if(!texto) return;

  agregarMsg("user",texto);
  input.value="";

  let respuesta = "Estoy analizando el mercado‚Ä¶ espera confirmaci√≥n.";
  if(texto.toLowerCase().includes("cerrar")){
    respuesta = "Sugiero cerrar parcialmente y asegurar ganancias.";
  }
  if(texto.toLowerCase().includes("entrar")){
    respuesta = document.getElementById("signal").innerText;
  }

  setTimeout(()=>agregarMsg("ia",respuesta),500);
}

function agregarMsg(tipo,texto){
  const div = document.createElement("div");
  div.className = `msg ${tipo}`;
  div.innerText = (tipo==="ia"?"IA: ":"T√∫: ") + texto;
  document.getElementById("chat").appendChild(div);
  document.getElementById("chat").scrollTop = 9999;
}
</script>

</body>
</html>
