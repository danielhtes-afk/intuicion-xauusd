<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>IntuiciÃ³n XAUUSD Â· IA Aprendizaje</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#0f1220;
  color:#fff;
}
.container{
  max-width:900px;
  margin:auto;
  padding:15px;
}
.card{
  background:#151a30;
  border-radius:12px;
  padding:15px;
  margin-bottom:15px;
}
h2,h3{
  margin:0 0 10px 0;
}
.flex{
  display:flex;
  justify-content:space-between;
  gap:10px;
}
.col{
  flex:1;
  background:#1c2240;
  padding:10px;
  border-radius:10px;
}
.big{
  font-size:26px;
  font-weight:bold;
}
.green{color:#4cff9b;}
.red{color:#ff5c5c;}
.gray{color:#aaa;}
button{
  padding:10px;
  border:none;
  border-radius:8px;
  cursor:pointer;
  font-weight:bold;
}
.btn-ok{background:#4cff9b;}
.btn-no{background:#ff5c5c;}
select{
  background:#1c2240;
  color:#fff;
  border:none;
  padding:6px;
  border-radius:6px;
}
</style>
</head>

<body>
<div class="container">

  <div class="card">
    <h2>ğŸ§  IntuiciÃ³n IA Â· XAUUSD</h2>
    Temporalidad:
    <select onchange="cambiarTF(this.value)">
      <option value="1m">1 Minuto</option>
      <option value="5m" selected>5 Minutos</option>
      <option value="15m">15 Minutos</option>
    </select>
  </div>

  <div class="card">
    <h3>ğŸ“Š Comparativo de Probabilidad</h3>

    <div class="flex">
      <div class="col">
        <h4>ğŸ”¼ ALZA (Compra)</h4>
        <div id="probBuy" class="big green">--%</div>
        <div id="estrBuy" class="gray">Estructura: --</div>
        <div id="timeBuy" class="gray">Tiempo: --</div>
      </div>

      <div class="col">
        <h4>ğŸ”½ BAJA (Venta)</h4>
        <div id="probSell" class="big red">--%</div>
        <div id="estrSell" class="gray">Estructura: --</div>
        <div id="timeSell" class="gray">Tiempo: --</div>
      </div>
    </div>
  </div>

  <div class="card">
    <h3>ğŸ¤– DecisiÃ³n IA</h3>
    <div id="decision" class="big gray">Analizando mercado...</div>
  </div>

  <div class="card">
    <h3>ğŸ“Œ Resultado de la OperaciÃ³n</h3>
    <button class="btn-ok" onclick="guardarResultado(true)">âœ… Resultado Positivo</button>
    <button class="btn-no" onclick="guardarResultado(false)">âŒ Resultado Negativo</button>
  </div>

</div>

<script>
/* ===== CONFIG ===== */
let timeframe = "5m";
let ultimaDireccion = null;
const KEY = "IA_XAUUSD";

/* ===== INIT ===== */
function initIA(){
  if(!localStorage.getItem(KEY)){
    localStorage.setItem(KEY, JSON.stringify({
      "1m":{wB:0,lB:0,wS:0,lS:0},
      "5m":{wB:0,lB:0,wS:0,lS:0},
      "15m":{wB:0,lB:0,wS:0,lS:0}
    }));
  }
}
initIA();

/* ===== TIMEFRAME ===== */
function cambiarTF(tf){
  timeframe = tf;
  calcular();
}

/* ===== CALCULO ===== */
function calcular(){
  const data = JSON.parse(localStorage.getItem(KEY))[timeframe];

  let totalBuy = data.wB + data.lB;
  let totalSell = data.wS + data.lS;

  let probBuy = totalBuy ? Math.round((data.wB/totalBuy)*100) : 50;
  let probSell = totalSell ? Math.round((data.wS/totalSell)*100) : 50;

  let sum = probBuy + probSell;
  probBuy = Math.round((probBuy/sum)*100);
  probSell = 100 - probBuy;

  document.getElementById("probBuy").innerText = probBuy+"%";
  document.getElementById("probSell").innerText = probSell+"%";

  document.getElementById("estrBuy").innerText =
    "Estructura: "+(probBuy>probSell?"Alcista":"DÃ©bil");
  document.getElementById("estrSell").innerText =
    "Estructura: "+(probSell>probBuy?"Bajista":"DÃ©bil");

  let tiempo =
    timeframe==="1m" ? "3â€“7 min (mÃ¡x 12)" :
    timeframe==="5m" ? "15â€“30 min (mÃ¡x 45)" :
    "30â€“90 min (mÃ¡x 2h)";

  document.getElementById("timeBuy").innerText = "Tiempo: "+tiempo;
  document.getElementById("timeSell").innerText = "Tiempo: "+tiempo;

  let dec = "Esperar confirmaciÃ³n";
  ultimaDireccion = null;

  if(Math.abs(probBuy-probSell)>=25){
    if(probBuy>probSell){
      dec = "âœ… COMPRA Â· Confianza "+probBuy+"% Â· TÃ³malo o dÃ©jalo";
      ultimaDireccion="buy";
    }else{
      dec = "âœ… VENTA Â· Confianza "+probSell+"% Â· TÃ³malo o dÃ©jalo";
      ultimaDireccion="sell";
    }
  }

  document.getElementById("decision").innerText = dec;
}

/* ===== APRENDIZAJE ===== */
function guardarResultado(ok){
  if(!ultimaDireccion) return alert("No habÃ­a seÃ±al clara");

  const all = JSON.parse(localStorage.getItem(KEY));
  const tf = all[timeframe];

  if(ultimaDireccion==="buy"){
    ok ?
