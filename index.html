<script>
// ================= INTUICI√ìN IA =================
const estados = ["FAVORABLE", "NEUTRO", "DESFAVORABLE"];
const contexto = estados[Math.floor(Math.random() * estados.length)];

let sugerencia = "Esperar";
let duracion = "‚Äî";
let confianzaTxt = "‚Äî";

if (contexto === "FAVORABLE") {
  sugerencia = "üü¢ Posible COMPRA";
  duracion = "5‚Äì15 min";
  confianzaTxt = "70%";
} else if (contexto === "DESFAVORABLE") {
  sugerencia = "üî¥ Posible VENTA";
  duracion = "5‚Äì15 min";
  confianzaTxt = "70%";
}

document.getElementById("contexto").innerText = contexto;
document.getElementById("sugerencia").innerText = sugerencia;
document.getElementById("duracion").innerText = duracion;
document.getElementById("confianza").innerText = confianzaTxt;
document.getElementById("senalGrafica").innerText = sugerencia;

// ================= VARIABLES IA =================
let volume = 1;
let pip = 0.01;
let leverage = 400;

const baseCapital = 100;
const minVolume = 1;
const maxVolume = 10;
const minPip = 0.01;
const maxPip = 0.10;

// ================= CONTROLES =================
function changeVolume(step) {
  volume = Math.min(maxVolume, Math.max(minVolume, volume + step));
  updateIA();
}

function changePip(step) {
  pip = parseFloat((pip + step).toFixed(2));
  pip = Math.min(maxPip, Math.max(minPip, pip));
  updateIA();
}

function updateLeverage(val) {
  leverage = Number(val);
  updateIA();
}

// ================= C√ÅLCULOS IA =================
function exposureUSD() {
  return baseCapital * volume * leverage;
}

function profitUSD() {
  const pipValuePer100k = 10; // aproximaci√≥n XAUUSD
  return pip * pipValuePer100k * (exposureUSD() / 100000);
}

function volatility() {
  return 0.005 + volume * 0.0005;
}

function timeToClose() {
  return Math.max(1, Math.ceil(pip / volatility()));
}

function structure() {
  if (pip <= 0.02) return "Scalp";
  if (pip <= 0.05) return "Impulso";
  return "Estructural";
}

function confidenceIA() {
  let score = 70;
  if (pip <= 0.02) score += 10;
  if (volume <= 5) score += 5;
  if (leverage >= 400) score -= 5;
  return Math.min(score, 90);
}

// ================= ACTUALIZAR UI =================
function updateIA() {
  const pipEl = document.getElementById("pipValue");
  const volEl = document.getElementById("volumeValue");
  const usdEl = document.getElementById("gananciaUsd");
  const timeEl = document.getElementById("tiempoCierre");
  const structEl = document.getElementById("estructura");
  const confEl = document.getElementById("confianzaIA");

  if (pipEl) pipEl.innerText = pip.toFixed(2);
  if (volEl) volEl.innerText = volume;
  if (usdEl) usdEl.innerText = `$${profitUSD().toFixed(2)}`;
  if (timeEl) timeEl.innerText = `${timeToClose()} min`;
  if (structEl) structEl.innerText = structure();
  if (confEl) confEl.innerText = `${confidenceIA()}%`;
}

// ================= TRADE =================
let tradeActivo = false;

function iniciarTrade(tipo) {
  tradeActivo = true;
  document.getElementBy
