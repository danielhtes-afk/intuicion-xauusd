<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>IntuiciÃ³n XAUUSD Â· IA Copiloto</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#0f1220;
  color:#eaeaff;
}
header{
  padding:12px;
  text-align:center;
  background:#161a33;
  font-size:20px;
  font-weight:bold;
}
.container{
  padding:10px;
}
.card{
  background:#161a33;
  border-radius:10px;
  padding:10px;
  margin-bottom:10px;
}
h3{color:#7dd3fc;margin:6px 0;}
.signal{
  text-align:center;
  font-size:22px;
  padding:12px;
  border-radius:8px;
}
.buy{background:#14532d;color:#4ade80;}
.sell{background:#7f1d1d;color:#f87171;}
.wait{background:#1f2933;color:#facc15;}
button,input,textarea{
  width:100%;
  margin-top:6px;
  padding:8px;
  border-radius:6px;
  border:none;
}
button{
  background:#2563eb;
  color:white;
  font-weight:bold;
}
.chat-box{
  height:220px;
  overflow-y:auto;
  background:#0b0e1a;
  padding:6px;
  border-radius:6px;
}
.chat-msg{font-size:14px;margin:4px 0;}
.user{color:#7dd3fc;}
.ia{color:#a7f3d0;}
</style>
</head>

<body>

<header>ğŸ§  IntuiciÃ³n XAUUSD Â· IA Copiloto</header>

<div class="container">

<!-- GRÃFICA -->
<div class="card">
<h3>ğŸ“ˆ GrÃ¡fica XAUUSD</h3>
<div id="tv_chart" style="height:420px;"></div>
<script src="https://s3.tradingview.com/tv.js"></script>
<script>
new TradingView.widget({
  symbol:"OANDA:XAUUSD",
  interval:"15",
  timezone:"Europe/Madrid",
  theme:"dark",
  container_id:"tv_chart"
});
</script>
</div>

<!-- SEMÃFORO -->
<div class="card">
<h3>ğŸš¦ SemÃ¡foro IA</h3>
<div id="signal" class="signal wait">ESPERANDO DATOS...</div>

<div id="tiempoEntrada">â±ï¸ Tiempo Ã³ptimo entrada: â€”</div>
<div id="contadorBox">â³ Entrada en: <span id="contador">â€”</span></div>
</div>

<!-- AVISAR ENTRADA -->
<div class="card">
<h3>ğŸ§‘â€ğŸ’» Avisar a la IA</h3>
<button onclick="entrar()">âœ… Ya entrÃ© al mercado</button>
<div id="estadoTrade">Sin trade activo</div>
<div id="tiempoSalida">â±ï¸ Tiempo Ã³ptimo de cierre: â€”</div>
</div>

<!-- CHAT -->
<div class="card">
<h3>ğŸ’¬ Chat IA</h3>
<div class="chat-box" id="chat"></div>
<textarea id="msg" placeholder="Habla con la IA..."></textarea>
<button onclick="enviar()">Enviar</button>
</div>

</div>

<script>
const API_KEY="d3cd94ff08974ed893ad7f77c1cd3b87";
const SYMBOL="XAUUSD";

let contadorInterval=null;
let tiempoRestante=0;
let tradeActivo=false;

// CHAT
function addMsg(t,c){
  chat.innerHTML+=`<div class="chat-msg ${c}">${t}</div>`;
  chat.scrollTop=chat.scrollHeight;
}
function enviar(){
  if(!msg.value) return;
  addMsg("ğŸ§‘â€ğŸ’» "+msg.value,"user");
  msg.value="";
  setTimeout(()=>addMsg("ğŸ¤– IA: MantÃ©n disciplina.","ia"),600);
}

// CONTADOR
function iniciarContador(min){
  clearInterval(contadorInterval);
  tiempoRestante=min*60;
  contadorInterval=setInterval(()=>{
    tiempoRestante--;
    contador.innerText=
      Math.floor(tiempoRestante/60)+":"+
      (tiempoRestante%60).toString().padStart(2,"0");
    if(tiempoRestante<=0){
      clearInterval(contadorInterval);
      contador.innerText="ENTRAR AHORA";
    }
  },1000);
}

// IA ENTRADA
function analizar(price){
  const s=document.getElementById("signal");
  if(price%2>1){
    s.className="signal buy";
    s.innerText="ğŸŸ¢ COMPRA";
    tiempoEntrada.innerText="â±ï¸ Esperar 2 min";
    iniciarContador(2);
  }else if(price%2<0.5){
    s.className="signal sell";
    s.innerText="ğŸ”´ VENTA";
    tiempoEntrada.innerText="â±ï¸ Esperar 3 min";
    iniciarContador(3);
  }else{
    s.className="signal wait";
    s.innerText="ğŸŸ¡ ESPERAR";
  }
}

// DATOS
async function datos(){
  const r=await fetch(`https://api.twelvedata.com/quote?symbol=${SYMBOL}&apikey=${API_KEY}`);
  const d=await r.json();
  if(d.price && !tradeActivo) analizar(parseFloat(d.price));
}
setInterval(datos,15000);

// ENTRADA
function entrar(){
  tradeActivo=true;
  estadoTrade.innerText="ğŸ“Œ Trade activo";
  tiempoSalida.innerText="â±ï¸ Cierre recomendado: 5â€“10 min";
  addMsg("ğŸ¤– IA: Trade registrado. No cierres por miedo.","ia");
}
</script>

</body>
</html>
